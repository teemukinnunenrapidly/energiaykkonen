# Task ID: 19
# Title: Implement Admin Panel Preview Page for Calculator
# Status: done
# Dependencies: 9, 17, 18
# Priority: medium
# Description: Create a preview page in the admin panel that displays the front-end calculator exactly as visitors see it, allowing administrators to test functionality and verify appearance without affecting the live site.
# Details:
- Create a new route `/admin/preview/page.tsx` accessible from the main admin navigation
- Implement a navigation link in the admin sidebar menu labeled "Calculator Preview"
- Render the full calculator component within the admin panel context, ensuring it:
  * Uses the same Tesla-style split-screen layout (70/30) as the public version
  * Shows the visualization panel on the left and scrollable form on the right
  * Loads the current brand customization settings from the database
  * Functions exactly like the public calculator with all form interactions
  * Displays a prominent "Preview Mode" indicator to distinguish from the live site
- Ensure the preview calculator uses the same calculation engine as the public version
- Add a refresh button to reload the preview with the latest customization settings
- Implement a toggle to switch between desktop and mobile viewport sizes for testing responsive behavior
- Add a "View Public Version" button that opens the live calculator in a new tab for comparison
- Ensure the preview doesn't submit actual leads to the database when testing form submission
- Add tooltips or help text explaining that this is a safe environment for testing changes
- Maintain all form validation and UI interactions identical to the public version

# Test Strategy:
1. Verify the preview page is accessible only to authenticated admin users
2. Confirm the calculator renders correctly within the admin panel with the same layout and styling as the public version
3. Test that all form interactions work properly:
   - Fill out each section of the form and verify validation works
   - Test calculations with various inputs and confirm results match expected outputs
   - Verify visualization updates correctly based on form inputs
4. Test the responsive toggle functionality:
   - Switch between desktop and mobile views
   - Verify the layout adapts appropriately for each viewport size
5. Confirm the "Preview Mode" indicator is clearly visible
6. Test that form submissions in preview mode don't create actual leads in the database
7. Verify that changes made in the brand customization section are reflected in the preview after refresh
8. Test the "View Public Version" button opens the correct URL in a new tab
9. Verify performance is acceptable within the admin panel context

# Subtasks:
## 1. Set Up Admin Preview Route and Navigation [done]
### Dependencies: None
### Description: Create a new route `/admin/preview/page.tsx` and add a 'Calculator Preview' link to the admin sidebar menu, ensuring only authenticated admin users can access it.
### Details:
Implement the route and navigation link in the admin panel. Restrict access to authenticated admin users only.

## 2. Render Calculator Component with Admin Context [done]
### Dependencies: 19.1
### Description: Render the full calculator component inside the admin panel using the Tesla-style 70/30 split-screen layout, loading current brand customization settings from the database.
### Details:
Ensure the calculator appears exactly as on the public site, with the visualization panel on the left and the scrollable form on the right, and loads the latest brand settings.
<info added on 2025-08-25T13:03:33.035Z>
All progress bars and step indicators have been removed from the preview page. The form now displays all sections together in a single scrollable container, eliminating step-by-step navigation elements and providing a cleaner, streamlined user experience that matches the scrollable design philosophy.
</info added on 2025-08-25T13:03:33.035Z>

## 3. Implement Preview Mode Functionality and Safety [done]
### Dependencies: 19.2
### Description: Add a prominent 'Preview Mode' indicator, ensure no actual leads are submitted, and provide tooltips or help text explaining the safe testing environment.
### Details:
Display a clear 'Preview Mode' banner, block real lead submissions, and add contextual help to reassure admins about safe testing.

## 4. Add Interactive Preview Controls [done]
### Dependencies: 19.2
### Description: Implement a refresh button to reload the latest customization settings, a toggle for desktop/mobile viewport simulation, and a 'View Public Version' button opening the live calculator in a new tab.
### Details:
Provide controls for refreshing the preview, switching viewport sizes, and comparing with the live site.

## 5. Ensure Full Calculator Functionality and Validation [done]
### Dependencies: 19.2
### Description: Maintain all form validation, UI interactions, and calculation logic identical to the public version within the preview, using the same calculation engine.
### Details:
Integrate the public calculator logic and validation, ensuring all interactions and calculations behave identically in preview mode.

